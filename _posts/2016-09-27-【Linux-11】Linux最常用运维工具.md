---
layout:  post    # 使用的布局（不需要改）
catalog: true   # 是否归档
author: 陈国林 # 作者
tags:         #标签
    - Linux
---

1. http://linux-training.be/sysadmin/ch08.html
2. https://linuxtools-rst.readthedocs.io/zh_CN/latest/index.html

# 一. gdb 程序调试

# 二. ldd 程序依赖库

# 三. lsof 一切皆文件

# 四. ps 进程查看器

# 五. pstack 跟踪进程栈

# 六. strace 跟踪进程系统调用

# 七. ipcs 查询进程间通信状态

# 八. top 任务管理器

# 九. free 查询可用内存

# 十. vmstat 监视内存使用情况

# 十一. iostat 监视I/O子系统

# 十二. sar 找出系统瓶颈

# 十三. readelf elf文件格式分析

# 十四. objdump 二进制文件分析

# 十五. nm 目标文件格式分析

# 十六. size 查看程序内存映像大小

# 十七. wget 文件下载

# 十八. scp 远程拷贝

# 十九. crontab 定时任务
`crontab` 可以用来在固定的间隔时间执行指定的系统指令或 shell 脚本，时间间隔的单位可以是`分钟`、`小时`、`日`、`月`、`周`及以上的任意组合，非常适合用于周期性的日志分析或数据备份等工作。

## ① crontab 介绍
`·crontab` 是Linux自带的定时任务管理工具，用户无须安装就可以直接使用，默认会自带以下文件与目录

1. `/etc/cron.allow`: 允许配置crontab的用户列表，文件允许不存在
2. `/etc/cron.deny`: 不允许配置crontab的用户列表，文件允许不存在
3. `/etc/crontab`: 系统级别crontab配置，不建议用户直接修改该文件
4. `/etc/cron.hourly/`: `小时`级别调度任务配置目录，目录下脚本可以被系统自动调用
5. `/etc/cron.daily/`: `天`级别调度任务配置目录，目录下脚本可以被系统自动调用
6. `/etc/cron.weekly/`: `周`级别调度任务配置目录，目录下脚本可以被系统自动调用
7. `/etc/cron.monthly/`: `月`级别调度任务配置目录，目录下脚本可以被系统自动调用
8. `/etc/cron.d/`: 非小时、天、周、月级别的调度任务配置目录，需要用户自行运行 `crontab -u username /etc/cron.d/xxxx` 载入crontab

上面提到的几个文件，有几个需要注意的点，总结如下
1. `/etc/cron.allow` 和 `/etc/cron.deny` 正常情况下不需要这2个文件，保证所有人都可以配置crontab任务
2. `/etc/crontab` 不建议用户直接修改这个文件
3. `/etc/cron.hourly/`、`/etc/cron.daily/`、`/etc/cron.weekly/`、`/etc/cron.monthly/` 这4个目录下的脚本需要满足以下条件，才能够成功被调度执行
   + 文件名只能包含 `[a-zA-Z0-9_-]` 这些字符，同时不能使用 `.sh` 结尾
   + 脚本必须要有 `可执行` 权限
   + 文件第一行必须为 `#!/bin/bash`

## ② crontab 命令
1. 启停crontab
   + `$ service crond start`
   + `$ service crond stop`
2. crontab常用命令
   + 任务文件载入crontab: `$ crontab -u {username} {file}`
   + 显示某个用户的crontab文件内容: `$ crontab -u {username} -l`
   + 编辑crontab文件内容: `$ crontab -u {username} -e`
   + 删除crontab文件内容: `$ crontab -u {username} -ir`
   
   `如果没有通过 -u 指定用户，默认使用为当前用户`
3. run-parts 可以用于执行 `/etc/cron.hourly/`等目录下脚本 （可以用来debug自己写的调度脚本是否能成功被执行）
   + `run-parts /etc/cron.hourly`
   + `run-parts /etc/cron.daily`
   + `run-parts /etc/cron.weekly`
   + `run-parts /etc/cron.monthly`

## ③ crontab 使用
正常情况下如果开发或运维有定时任务需求都可以通过 `crontab` 来实现，但是配置 `crontab` 需要登录机器这会带来一定的风险。现在有很多开源的 `任务调度` 平台可以用来实现我们这个需求，除此之外 `K8s` 的`Job`和`CronJob`也能够支持任务定时调度。

所以，如果只是简单的需求可以直接使用 `crontab`，但是非常不推荐在生产环境大量使用，因为不仅低效而且风险很大。

使用 `crontab` 有以下几种方式  [crontab 定时任务](https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/crontab.html)

1. 直接使用 `$ crontab -u {username} -e` 编辑某个用户的crontab文件，文件每一行格式如下
   ```
   Minute Hour Day Month Week command
   0-59  0-23  1-31 1-12 0-6  command

   Minute: 每个小时的第几分钟执行该任务
   Hour: 每天的第几个小时执行该任务
   Day: 每月的第几天执行该任务
   Month: 每年的第几个月执行该任务
   DayOfWeek: 每周的第几天执行该任务，0表示周日
   Command: 指定要执行的程序 、脚本或命令
   
   备注: 在这些字段里，除了Command是必须指定的字段以外，其它字段皆为可选。对于不指定的字段，要用*来填补其位置
   ```
2. 根据不同需求编写调度脚本
   + 天级别调度: 
3.    
   
`最佳实践: `




